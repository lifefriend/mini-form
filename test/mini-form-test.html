<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <script src="../bower_components/shadydom/shadydom.min.js"></script>
  <script src="../bower_components/custom-elements/custom-elements.min.js"></script>
  <script src="../node_modules/web-component-tester/browser.js"></script>
  <script src="../mini-form.js"></script>
</head>
<body>

  <mini-form theme="blue-green">What?!</mini-form>

  <script>

    suite('<mini-form>', function() {

      let component = document.querySelector('mini-form');
      let input = component.shadowRoot.querySelector('input[type="text"]');
      let button = component.shadowRoot.querySelector('button');
      let errorMsg = component.shadowRoot.querySelector('.error');

      test('renders div', () => {
        assert.isOk(component.shadowRoot.querySelector('div'));
      });

      test('renders input', () => {
        assert.isOk(component.shadowRoot.querySelector('input[type="text"]'));
      });

      test('render button', () => {
        assert.isOk(component.shadowRoot.querySelector('button'));
      });

      test('renders question', () => {
        let index = component.innerText.indexOf('What?!');
        assert.isAtLeast(index, 0);
      });

      test('applies color theme to button', () => {
       let buttonColor = window.getComputedStyle(button).getPropertyValue('background-color');
       assert.equal(buttonColor, 'rgb(105, 240, 174)');
     });

     test('applies color theme to header', () => {
       let header = component.shadowRoot.querySelector('header');
       let headerColor = window.getComputedStyle(header).getPropertyValue('background-color');
       assert.equal(headerColor, 'rgb(33, 150, 243)');
     });

     test('displays an error message on submit', () => {
      button.click();
      let index = errorMsg.innerText.indexOf('Don\'t you have something to say?');
      assert.isAtLeast(index, 0);
    });

    test('clears error message on focus', () => {
      input.focus();
      let index = errorMsg.innerText.indexOf('Don\'t you have something to say?');
      assert.isAtLeast(index, -1);
    });

    test('displays a success message on submit', () => {
      input.value = 'Some text';
      button.click();
      let index = component.shadowRoot.querySelector('.mdl-card').innerText.indexOf('Thank you.');
      assert.isAtLeast(index, 0);
    });

  });
  </script>
</body>
</html>
